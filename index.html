<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>BY DERA - M.H.S PRO</title>

<style>
body{
    background:#0e0e0e;
    font-family:Arial;
    color:white;
    text-align:center;
    margin:0;
    padding:15px;
}

.title{
    font-size:20px;
    margin-bottom:15px;
}

.label{
    color:#ffd000;
    text-align:left;
    width:90%;
    margin:auto;
    margin-top:10px;
}

.box{
    width:90%;
    padding:12px;
    margin:8px auto;
    background:#1b1f24;
    border:2px solid #ffd000;
    border-radius:10px;
    color:white;
    font-size:18px;
    text-align:center;
}

.hash-box{
    width:90%;
    padding:12px;
    margin:8px auto;
    background:#1b1f24;
    border:2px solid #ffd000;
    border-radius:10px;
    color:white;
}

.btn{
    width:90%;
    padding:14px;
    background:#00c853;
    border:none;
    border-radius:10px;
    font-weight:bold;
    margin-top:10px;
}

#graphContainer{
    width:100%;
    height:250px;
    background:#111;
    margin-top:15px;
    position:relative;
}

#multiplier{
    position:absolute;
    top:35%;
    width:100%;
    font-size:40px;
    color:#00ff66;
}

canvas{
    position:absolute;
    bottom:0;
    left:0;
}

.result{
    background:#d50000;
    padding:12px;
    margin-top:15px;
    border-radius:10px;
}

.countdown{
    margin-top:10px;
    font-size:18px;
    color:#00ff66;
}

.history{
    margin-top:15px;
    background:#1b1f24;
    padding:10px;
    border-radius:10px;
    text-align:left;
}

.history h3{
    color:#ffd000;
}
</style>
</head>

<body>

<div class="title">BY DERA - M.H.S PRO</div>

<div class="label">ðŸ•’ HEURE DE DÃ‰PART</div>
<input class="box" id="heure" placeholder="01:31:57">

<div class="label"># HASH</div>
<textarea class="hash-box" id="hash" rows="2"></textarea>

<button class="btn" onclick="startGame()">âš¡ CALCULER</button>

<div id="graphContainer">
    <div id="multiplier">0x</div>
    <canvas id="graph"></canvas>
</div>

<div class="result" id="resultBox">
RÃ©sultat final : -
</div>

<div class="countdown" id="countdown"></div>

<div class="history">
<h3>Historique</h3>
<div id="historyList"></div>
</div>

<script>

let canvas = document.getElementById("graph");
let ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = 250;

let historyArray = [];
let countdownInterval;

function startGame(){

    let heureInput = document.getElementById("heure").value;
    let hash = document.getElementById("hash").value;

    if(heureInput=="" || hash==""){
        alert("Fenoy daholo!");
        return;
    }

    // ===== RÃ©sultat anaky 5 =====
    let total = hash.length + heureInput.length;
    let finalValue = ((total % 5)+1)*5;

    // ===== Graph Crash =====
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.beginPath();
    ctx.moveTo(0, canvas.height);

    let current = 0;
    let x = 0;
    let multiplierDisplay = document.getElementById("multiplier");

    let interval = setInterval(function(){

        current += 0.3;
        x += 5;

        let y = canvas.height - (current * 6);

        ctx.lineTo(x,y);
        ctx.strokeStyle = "#00ff66";
        ctx.stroke();

        multiplierDisplay.innerHTML = current.toFixed(1) + "x";

        if(current >= finalValue){
            clearInterval(interval);
            multiplierDisplay.innerHTML = finalValue + "x";
            afterCrash(heureInput, finalValue);
        }

    },30);
}

function afterCrash(heureInput, result){

    // ===== Tour manaraka +2 min =====
    let parts = heureInput.split(":");
    let date = new Date();
    date.setHours(parts[0]);
    date.setMinutes(parts[1]);
    date.setSeconds(parts[2]);
    date.setMinutes(date.getMinutes() + 2);

    let nextTime =
        date.getHours().toString().padStart(2,'0') + ":" +
        date.getMinutes().toString().padStart(2,'0') + ":" +
        date.getSeconds().toString().padStart(2,'0');

    document.getElementById("resultBox").innerHTML =
        "RÃ©sultat final : " + result + "x<br>Tour manaraka : " + nextTime;

    addHistory(heureInput + " â†’ " + result + "x (" + nextTime + ")");

    startCountdown(nextTime);
}

function startCountdown(targetTime){

    clearInterval(countdownInterval);

    countdownInterval = setInterval(function(){

        let now = new Date();
        let parts = targetTime.split(":");

        let target = new Date();
        target.setHours(parts[0]);
        target.setMinutes(parts[1]);
        target.setSeconds(parts[2]);

        let diff = Math.floor((target - now)/1000);

        if(diff <= 0){
            document.getElementById("countdown").innerHTML =
                "ðŸš€ Tour manaraka izao!";
            clearInterval(countdownInterval);
            return;
        }

        document.getElementById("countdown").innerHTML =
            "Countdown: " + diff + " sec";

    },1000);
}

function addHistory(value){

    historyArray.unshift(value);

    if(historyArray.length > 10){
        historyArray.pop();
    }

    let list = document.getElementById("historyList");
    list.innerHTML = "";

    historyArray.forEach(function(item){
        list.innerHTML += "<div>"+item+"</div>";
    });
}

</script>

</body>
</html>
